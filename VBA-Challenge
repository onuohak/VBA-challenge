Sub Stock_Price_Analysis()'Loop through each sheetFor Each ws In Worksheets'Declare the variablesDim Ticker As StringDim Row As IntegerDim greatest_ticker As StringDim greatest_increase As DoubleDim lowest_ticker As StringDim greatest_decrease As DoubleDim total_ticker As StringDim greatest_total As Double'Input the Header Text for wsws.Cells(1, 9).Value = "Ticker"ws.Cells(1, 10).Value = "Yearly Change"ws.Cells(1, 11).Value = "Percent Change"ws.Cells(1, 12).Value = "Total Stock Volume"ws.Cells(2, 14).Value = "Greatest % Increase"ws.Cells(3, 14).Value = "Greatest % Decrease"ws.Cells(4, 14).Value = "Greatest Total Volume"ws.Cells(1, 15).Value = "Ticker"ws.Cells(1, 16).Value = "Value"Row = 2'Testing a smaller sampleFor i = 2 To 100000open_stockprice = ws.Cells(i, 3).Valueclose_stockprice = ws.Cells(i, 6).Valuevolume = ws.Cells(i, 7).Value'If the next row's ticker does not equal the current row, then input the previous ticker, add IfIf ws.Cells(i, 1).Value <> ws.Cells(i + 1, 1).Value Thenc = close_stockprice - open_stockpriceo = open_stockpricea = volumeyearly_change = cdenom = denom + osum_volume = sum_volume + apercent_change = (yearly_change / denom) * 100ws.Cells(Row, 9).Value = Tickerws.Cells(Row, 10).Value = yearly_changews.Cells(Row, 11).Value = percent_changews.Cells(Row, 12).Value = sum_volumeRow = Row + 1yearly_change = 0denom = 0percent_change = 0sum_volume = 0ElseTicker = ws.Cells(i, 1).Valuec = close_stockprice - open_stockpriceyearly_change = yearly_change + ca = volumesum_volume = sum_volume + ao = open_stockpricedenom = denom + oEnd IfNext i'Greatest Percent Increase Calculationgreatest_increase = 0For e = 2 To 400    If ws.Cells(e, 11).Value > greatest_increase Then        greatest_ticker = ws.Cells(e, 9).Value        greatest_increase = ws.Cells(e, 11).Value    End IfNext ews.Cells(2, 15).Value = greatest_tickerws.Cells(2, 16).Value = greatest_increase'Greatest Percent Decreasegreatest_decrease = 0For f = 2 To 400    If ws.Cells(f, 11).Value < greatest_decrease Then        lowest_ticker = ws.Cells(f, 9).Value        greatest_decrease = ws.Cells(f, 11).Value    End IfNext fws.Cells(3, 15).Value = lowest_tickerws.Cells(3, 16).Value = greatest_decrease'Greatest Total Volumegreatest_total = 0For g = 2 To 402    If ws.Cells(g, 12).Value > greatest_total Then        total_ticker = ws.Cells(g, 9).Value        greatest_total = ws.Cells(g, 12).Value    End IfNext gws.Cells(4, 15).Value = total_tickerws.Cells(4, 16).Value = greatest_total'Background Color Coding Yearly ChangeFor i = 2 To lastrow_summary_tableIf ws.Cells(i, 10).Value > 0 Then    ws.Cells(i, 10).Interior.ColorIndex = vbRed    Else        ws.Cells(1, 10).Interior.ColorIndex = vbGreen    End If    Next iNext wsEnd Sub
